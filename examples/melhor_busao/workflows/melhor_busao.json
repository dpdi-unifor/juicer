{  
   "workflow":{  
      "id":223,
      "name":"melhor_busao",
      "framework":"Spark",
      "tasks":[  
         {  
            "id":"Read_Ticketing_data",
            "log_level":"INFO",
            "operation":{  
               "name":"DATA_READER",
               "id":434
            },
            "parameters":[  
               {  
                  "name":"database_id",
                  "value":71,
                  "category":"EXECUTION"
               }
            ],
            "ports":[  
               {  
                  "direction":"out",
                  "id":1,
                  "interface":"dataframe"
               }
            ]
         },
         {  
            "id":"Read_GPS_data",
            "log_level":"INFO",
            "operation":{  
               "name":"DATA_READER",
               "id":434
            },
            "parameters":[  
               {  
                  "name":"database_id",
                  "value":72,
                  "category":"EXECUTION"
               }
            ],
            "ports":[  
               {  
                  "direction":"out",
                  "id":2,
                  "interface":"dataframe"
               }
            ]
         },
         {  
            "id":"Read_IBGE_data",
            "log_level":"INFO",
            "operation":{  
               "name":"DATA_READER",
               "id":434
            },
            "parameters":[  
               {  
                  "name":"database_id",
                  "value":70,
                  "category":"EXECUTION"
               }
            ],
            "ports":[  
               {  
                  "direction":"out",
                  "id":3,
                  "interface":"dataframe"
               }
            ]
         },
         {  
            "id":"Filter_CODLINHA_GPS",
            "log_level":"INFO",
            "operation":{  
               "name":"FILTER",
               "id":434
            },
            "parameters":[  
               {
                  "name":"expression",
                  "value":"COD_LINHA == 801",
                  "category":"EXECUTION"
               }
            ],
            "ports":[  
               {  
                  "direction":"in",
                  "id":2,
                  "interface":"dataframe"
               },
               {  
                  "direction":"out",
                  "id":5,
                  "interface":"dataframe"
               }
            ]
         },
         {  
            "id":"Filter_CODLINHA_Ticketing",
            "log_level":"INFO",
            "operation":{  
               "name":"FILTER",
               "id":434
            },
            "parameters":[  
               {
                  "name":"expression",
                  "value":"CODLINHA == 801",
                  "category":"EXECUTION"
               }
            ],
            "ports":[  
               {  
                  "direction":"in",
                  "id":1,
                  "interface":"dataframe"
               },
               {  
                  "direction":"out",
                  "id":4,
                  "interface":"dataframe"
               }
            ]
         },
         {  
            "id":"Bins_Ticketing",
            "log_level":"INFO",
            "operation":{  
               "name":"DATETIME_TO_BINS",
               "id":434
            },
            "parameters":[  
               {  
                  "name":"target_column",
                  "value":"DATAUTILIZACAO",
                  "category":"EXECUTION"
               },
               {  
                  "name":"new_column",
                  "value":"BINS_5_MIN",
                  "category":"EXECUTION"
               },
               {  
                  "name":"group_size",
                  "value":5,
                  "category":"EXECUTION"
               }
            ],
            "ports":[  
               {  
                  "direction":"in",
                  "id":4,
                  "interface":"dataframe"
               },
               {  
                  "direction":"out",
                  "id":6,
                  "interface":"dataframe"
               }
            ]
         },
 {  
            "id":"Bins_GPS",
            "log_level":"INFO",
            "operation":{  
               "name":"DATETIME_TO_BINS",
               "id":434
            },
            "parameters":[  
               {  
                  "name":"target_column",
                  "value":"DTHR",
                  "category":"EXECUTION"
               },
               {  
                  "name":"new_column",
                  "value":"BINS_5_MIN",
                  "category":"EXECUTION"
               },
               {  
                  "name":"group_size",
                  "value":5,
                  "category":"EXECUTION"
               }
            ],
            "ports":[  
               {  
                  "direction":"in",
                  "id":5,
                  "interface":"dataframe"
               },
               {  
                  "direction":"out",
                  "id":7,
                  "interface":"dataframe"
               }
            ]
         },
	 {
            "id":"SELECT_Ticketing",
            "log_level":"INFO",
            "operation":{
               "name":"SELECT",
               "id":434
            },
            "parameters":[
               {
                  "name":"columns",
                  "value":["CODLINHA","CODVEICULO","BINS_5_MIN","NUMEROCARTAO","DATAUTILIZACAO"],
                  "category":"EXECUTION"
               }
            ],
            "ports":[
               {
                  "direction":"in",
                  "id":6,
                  "interface":"dataframe"
               },
               {
                  "direction":"out",
                  "id":8,
                  "interface":"dataframe"
               }
            ]
         },
	 {
            "id":"SORT_Ticketing",
            "log_level":"INFO",
            "operation":{
               "name":"SORT",
               "id":434
            },
            "parameters":[
               {
                  "name":"columns",
                  "value":["CODLINHA","CODVEICULO","BINS_5_MIN","DATAUTILIZACAO"],
                  "category":"EXECUTION"
               },
               {
                  "name":"ascending",
                  "value":["True","True","True","True"],
                  "category":"EXECUTION"
               }
            ],
            "ports":[
               {
                  "direction":"in",
                  "id":8,
                  "interface":"dataframe"
               },
               {
                  "direction":"out",
                  "id":9,
                  "interface":"dataframe"
               }
            ]
         },
	 {
            "id":"Aggregation_GPS",
            "log_level":"INFO",
            "operation":{
               "name":"AGGREGATION",
               "id":434
            },
            "parameters":[
               {
                  "name":"columns",
                  "value":["LAT","LON"],
                  "category":"EXECUTION"
               },
               {
                  "name":"functions",
                  "value":["first","first"],
                  "category":"EXECUTION"
               },
               {
                  "name":"new_names",
                  "value":["LAT","LON"],
                  "category":"EXECUTION"
               },
               {
                  "name":"group_by",
                  "value":["COD_LINHA","VEIC","BINS_5_MIN"],
                  "category":"EXECUTION"
               }
            ],
            "ports":[
               {
                  "direction":"in",
                  "id":7,
                  "interface":"dataframe"
               },
               {
                  "direction":"out",
                  "id":10,
                  "interface":"dataframe"
               }
            ]
         },
	 {
            "id":"Join_Ticketing_GPS",
            "log_level":"INFO",
            "operation":{
               "name":"JOIN",
               "id":434
            },
            "parameters":[
               {
                  "name":"left_attributes",
                  "value":["CODLINHA","CODVEICULO","BINS_5_MIN"],
                  "category":"EXECUTION"
               },
               {
                  "name":"right_attributes",
                  "value":["COD_LINHA","VEIC","BINS_5_MIN"],
                  "category":"EXECUTION"
               },
               {
                  "name":"keep_right_keys",
                  "value":"False",
                  "category":"EXECUTION"
               },
               {
                  "name":"match_case",
                  "value":"False",
                  "category":"EXECUTION"
               },
               {
                  "name":"join_type_param",
                  "value":"inner",
                  "category":"EXECUTION"
               }
            ],
            "ports":[
               {
                  "direction":"in",
                  "id":9,
                  "interface":"dataframe"
               },
               {
                  "direction":"in",
                  "id":10,
                  "interface":"dataframe"
               },
               {
                  "direction":"out",
                  "id":11,
                  "interface":"dataframe"
               }
            ]
         },
	 {
            "id":"SORT_Ticketing_GPS",
            "log_level":"INFO",
            "operation":{
               "name":"SORT",
               "id":434
            },
            "parameters":[
               {
                  "name":"columns",
                  "value":["NUMEROCARTAO","DATAUTILIZACAO"],
                  "category":"EXECUTION"
               },
               {
                  "name":"ascending",
                  "value":["True","True"],
                  "category":"EXECUTION"
               }
            ],
            "ports":[
               {
                  "direction":"in",
                  "id":11,
                  "interface":"dataframe"
               },
               {
                  "direction":"out",
                  "id":12,
                  "interface":"dataframe"
               }
            ]
         },
	 {
            "id":"Aggregation_count_Ticket_GPS",
            "log_level":"INFO",
            "operation":{
               "name":"AGGREGATION",
               "id":434
            },
            "parameters":[
               {
                  "name":"columns",
                  "value":["NUMEROCARTAO"],
                  "category":"EXECUTION"
               },
               {
                  "name":"functions",
                  "value":["count"],
                  "category":"EXECUTION"
               },
               {
                  "name":"new_names",
                  "value":["COUNT"],
                  "category":"EXECUTION"
               },
               {
                  "name":"group_by",
                  "value":["NUMEROCARTAO"],
                  "category":"EXECUTION"
               }
            ],
            "ports":[
               {
                  "direction":"in",
                  "id":12,
                  "interface":"dataframe"
               },
               {
                  "direction":"out",
                  "id":13,
                  "interface":"dataframe"
               }
            ]
         }
      ]
   },
   "user":{  
      "login":"fernando",
      "id":432,
      "name":"Fernando Carvalho"
   }
}
